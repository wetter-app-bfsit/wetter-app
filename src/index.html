<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Wetter-App mit Open-Meteo und BrightSky Integration">
  <meta name="theme-color" content="#007BFF">
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>ğŸŒ¦ï¸</text></svg>">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect fill='%23007BFF' width='180' height='180' rx='40'/><text x='90' y='130' font-size='140' text-anchor='middle'>ğŸŒ¦ï¸</text></svg>">

  <title>ğŸŒ¦ï¸ Wetter App - Aktuelle Wetterdaten</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Header -->
  <header class="app-header">
    <div class="header-content">
      <h1 class="app-title">ğŸŒ¦ï¸ Wetter App</h1>
      <div class="header-controls">
        <button id="modeToggle" class="btn-icon" title="Dark Mode Toggle">ğŸŒ™</button>
        <button id="pushToggle" class="btn-icon" title="Push-Benachrichtigungen aktivieren">ğŸ””</button>
        <button id="settingsBtn" class="btn-icon" title="Einstellungen">âš™ï¸</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="app-container">
    <!-- Error Container -->
    <div id="error-container" class="error-container"></div>

    <!-- Search Section -->
    <section class="search-section">
      <div class="search-box">
        <input 
          id="cityInput" 
          type="text" 
          placeholder="Ort eingeben (z.B. Berlin, MÃ¼nchen)..."
          class="search-input"
          autocomplete="off"
        >
        <button id="searchBtn" class="btn-primary search-btn">ğŸ” Suchen</button>
      </div>

      <!-- Recent Cities -->
      <div id="recent-cities" class="recent-cities-section"></div>

      <!-- Favorites -->
      <div class="favorites-section">
        <h3>â­ Favoriten</h3>
        <div id="favorites-list" class="favorites-list"></div>
      </div>
    </section>

    <!-- Current Weather Display -->
    <section id="current-weather" class="weather-section">
      <div class="empty-state">
        <p>ğŸ” Geben Sie einen Ort ein um Wetterdaten zu sehen</p>
      </div>
    </section>

    <!-- Forecast Section -->
    <section id="forecast-container" class="forecast-section"></section>

    <!-- API Sources Comparison -->
    <section id="sources-comparison" class="sources-section">
      <h2>ğŸ“Š API Quellen Vergleich</h2>
      <div class="sources-grid">
        <div id="source-openmeteo" class="source-card">
          <h3>ğŸŒ Open-Meteo</h3>
          <div class="source-content"></div>
        </div>
        <div id="source-brightsky" class="source-card">
          <h3>â˜ï¸ BrightSky</h3>
          <div class="source-content"></div>
        </div>
      </div>
    </section>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>âš™ï¸ Einstellungen</h2>
          <button class="modal-close" data-close="settings-modal">&times;</button>
        </div>
        <div class="modal-body">
          <!-- Units Toggle -->
          <div class="settings-group">
            <label class="settings-label">
              <span>ğŸŒ¡ï¸ Temperatureinheit:</span>
              <select id="temp-unit-select" class="settings-select">
                <option value="C">Celsius (Â°C)</option>
                <option value="F">Fahrenheit (Â°F)</option>
              </select>
            </label>
          </div>

          <div class="settings-group">
            <label class="settings-label">
              <span>ğŸ’¨ Windgeschwindigkeit:</span>
              <select id="wind-unit-select" class="settings-select">
                <option value="km/h">Kilometer pro Stunde (km/h)</option>
                <option value="m/s">Meter pro Sekunde (m/s)</option>
              </select>
            </label>
          </div>

          <!-- Cache Settings -->
          <div class="settings-group">
            <label class="settings-label">
              <input type="checkbox" id="cache-enabled" checked>
              <span>Caching aktivieren</span>
            </label>
          </div>

          <!-- Cache Management -->
          <div class="settings-group">
            <button id="clear-cache-btn" class="btn-secondary">ğŸ§¹ Cache leeren</button>
            <button id="clear-recent-btn" class="btn-secondary">ğŸ—‘ï¸ Verlauf lÃ¶schen</button>
          </div>

          <!-- VAPID Key for Push (optional) -->
          <div class="settings-group">
            <label class="settings-label">
              <span>ğŸ” VAPID Public Key (optional):</span>
              <input id="vapidKeyInput" class="settings-input" placeholder="Base64 URL-safe Public VAPID Key">
            </label>
            <div style="display:flex;gap:8px;margin-top:8px;align-items:center;">
              <button id="saveVapidBtn" class="btn-secondary">Speichern</button>
              <button id="fetchVapidBtn" class="btn-secondary">Fetch VAPID</button>
            </div>
          </div>

          <!-- API Status -->
          <div class="settings-group">
            <h3>ğŸ“Š API Status</h3>
            <div id="api-status" class="api-status-list"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
      <p class="footer-text">
        ğŸŒ Datenquellen: 
        <a href="https://open-meteo.com" target="_blank">Open-Meteo</a> | 
        <a href="https://brightsky.dev" target="_blank">BrightSky</a> | 
        <a href="https://nominatim.org" target="_blank">Nominatim</a>
      </p>
      <p class="footer-text">
        <small>Â© 2025 Wetter-App | <a href="#privacy">Datenschutz</a> | <a href="#terms">Nutzungsbedingungen</a></small>
      </p>
    </footer>
  </main>

  <!-- Modal Overlay -->
  <div id="modal-overlay" class="modal-overlay"></div>
  <script>
    // PWA - Service Worker registrieren
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').then(reg => {
        console.log('âœ… Service Worker registriert:', reg);
      }).catch(err => {
        console.warn('âŒ Service Worker Registrierung fehlgeschlagen:', err);
      });
    }
  </script>

  <!-- Scripts - Utils -->
  <script src="utils/constants.js"></script>
  <script src="utils/cache.js"></script>
  <script src="utils/validation.js"></script>

  <!-- Scripts - API -->
  <script src="api/weather.js"></script>
  <script src="api/brightsky.js"></script>

  <!-- Scripts - UI Components -->
  <script src="ui/errorHandler.js"></script>
  <script src="ui/searchInput.js"></script>
  <script src="ui/weatherDisplay.js"></script>

  <!-- Scripts - Main App -->
  <script src="app.js"></script>
</body>
</html>
